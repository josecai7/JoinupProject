<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:customcontrols="clr-namespace:Joinup.CustomControls"
             xmlns:controls="clr-namespace:Joinup.Controls"
             xmlns:flv="clr-namespace:DLToolkit.Forms.Controls;assembly=DLToolkit.Forms.Controls.FlowListView"
             xmlns:ffimageloading="clr-namespace:FFImageLoading.Forms;assembly=FFImageLoading.Forms"            	
             xmlns:cv="clr-namespace:Xamarin.Forms;assembly=Xamarin.Forms.CarouselView"
             xmlns:fftransformations="clr-namespace:FFImageLoading.Transformations;assembly=FFImageLoading.Transformations"
             x:Class="Joinup.Views.PlanPage">
    <ContentPage.Content>
        <ScrollView Orientation="Vertical" VerticalOptions="FillAndExpand">
            <StackLayout
                Orientation="Vertical">
                <cv:CarouselView 
                    ItemsSource="{Binding Plan.PlanImages}"
                    HeightRequest="230"
                    VerticalOptions="Start"
                    BackgroundColor="AliceBlue">
                    <cv:CarouselView.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="230"/>
                                </Grid.RowDefinitions>
                                <ffimageloading:CachedImage 
                                        BackgroundColor="AliceBlue"
                                        Grid.Row="0"
                                        Source="{Binding ImageFullPath}"
                                        Aspect="AspectFill" 
                                        HeightRequest="230"/>
                            </Grid>
                        </DataTemplate>
                    </cv:CarouselView.ItemTemplate>
                </cv:CarouselView>
                <StackLayout
                    Spacing="0"
                    Orientation="Vertical"
                    Margin="16,8,16,0">

                    <!-- Title and type -->
                    <Label
                        Text="{Binding Plan.Name}"
                        Style="{StaticResource TitleFont}"
                        TextColor="{StaticResource SecondaryTextColor}"/>
                    <Label
                        Text="{Binding Plan.FormattedPlanType}"
                        Style="{StaticResource SubtitleFont}"
                        TextColor="{StaticResource TertiaryTextColor}"/>

                    <controls:SeparatorLine
                        Margin="0,16,0,16"/>

                    <!-- Organizer -->
                    <Grid
                        RowSpacing="0"
                        ColumnSpacing="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <ffimageloading:CachedImage 
                            Grid.RowSpan="2"
                            Grid.Column="0"
                            Source="{Binding Plan.User.UserImage}"
                            Aspect="AspectFit">
                            <ffimageloading:CachedImage.Transformations>
                                <fftransformations:CircleTransformation/>
                            </ffimageloading:CachedImage.Transformations>
                        </ffimageloading:CachedImage>
                        <Label
                            Grid.Column="1"
                            Grid.Row="0"
                            Text="{Binding Plan.User.Name}"
                            Style="{StaticResource TitleElementFont}"
                            TextColor="{StaticResource SecondaryTextColor}"/>
                        <Label
                            Grid.Column="1"
                            Grid.Row="1"
                            Text="Owned"
                            Style="{StaticResource TitleElementFont}"
                            TextColor="{StaticResource PrimaryColor}"/>
                    </Grid>

                    <controls:SeparatorLine
                        Margin="0,16,0,16"/>
                    
                    <!-- Date and time -->
                    <Grid
                        RowSpacing="0"
                        ColumnSpacing="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <customcontrols:FontIcon
                            Grid.Column="0"
                            Grid.RowSpan="3"
                            IconColor="{StaticResource TertiaryTextColor}"
                            Icon="clock-outline"
                            IconSize="{StaticResource IconBigSize}"
                            VerticalOptions="Start"
                            HorizontalOptions="Center">
                        </customcontrols:FontIcon>
                        <Label
                            Grid.Column="1"
                            Grid.Row="0"
                            Text="{Binding Plan.FormattedDate}"
                            Style="{StaticResource TitleElementFont}"
                            TextColor="{StaticResource SecondaryTextColor}"/>
                        <Label
                            Grid.Column="1"
                            Grid.Row="1"
                            Text="{Binding Plan.FormattedHour}"
                            Style="{StaticResource TitleElementFont}"
                            TextColor="{StaticResource SecondaryTextColor}"/>
                        <Label
                            Grid.Column="1"
                            Grid.Row="2"
                            Text="Add to Calendar"
                            Style="{StaticResource TitleElementFont}"
                            TextColor="{StaticResource PrimaryColor}"/>
                    </Grid>

                    <controls:SeparatorLine
                        Margin="0,16,0,16"/>

                    <!-- Assistants -->
                    <Grid
                        RowSpacing="0"
                        ColumnSpacing="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <customcontrols:FontIcon
                            Grid.Column="0"
                            Grid.Row="0"
                            IconColor="{StaticResource TertiaryTextColor}"
                            Icon="account-outline"
                            IconSize="{StaticResource IconBigSize}"
                            VerticalOptions="Start"
                            HorizontalOptions="Center">
                        </customcontrols:FontIcon>
                        <Label
                            VerticalOptions="Center"
                            Grid.Column="1"
                            Grid.Row="0"
                            Text="13 personas van a ir"
                            Style="{StaticResource TitleElementFont}"
                            TextColor="{StaticResource SecondaryTextColor}"/>

                        <flv:FlowListView 
                            Grid.ColumnSpan="2"
                            Grid.Row="1"
                            SeparatorVisibility="None" 
                            HasUnevenRows="true"
			                FlowColumnMinWidth="45" 
                            FlowItemsSource="{Binding Images}">

                            <flv:FlowListView.FlowColumnTemplate>
                                <DataTemplate>
                                    <ffimageloading:CachedImage 
                                        Source="{Binding Plan.DefaultImageFullPath}"
                                        Aspect="AspectFit"> 
                                        <ffimageloading:CachedImage.Transformations>
                                            <fftransformations:CircleTransformation/>
                                        </ffimageloading:CachedImage.Transformations>
                                    </ffimageloading:CachedImage>
                                </DataTemplate>
                            </flv:FlowListView.FlowColumnTemplate>

                        </flv:FlowListView>

                    </Grid>

                    <controls:SeparatorLine
                        Margin="0,16,0,16"/>

                    <!-- Description -->
                    <Label
                        Text="{Binding Plan.Description}"
                        Style="{StaticResource TitleElementFont}"
                        TextColor="{StaticResource SecondaryTextColor}"/>
                    
                </StackLayout>

        </StackLayout>
        </ScrollView>
    </ContentPage.Content>
</ContentPage>